<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Register - EVOSGPT</title>
  <style>
    :root {
      --bg-color: #f5f7fa;
      --text-color: #333;
      --primary-color: #00d4ff;
      --card-bg: #fff;
      --border-color: #ccc;
      --accent: #ff9800;
    }
    [data-theme="dark"] {
      --bg-color: #121212;
      --text-color: #f5f5f5;
      --card-bg: #1f1f1f;
      --border-color: #333;
    }
    body {
      font-family: Arial, sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
    }
    .form-box {
      width: 100%;
      max-width: 400px;
      padding: 25px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: var(--primary-color);
    }
    input, button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      font-size: 14px;
    }
    input {
      background: var(--card-bg);
      color: var(--text-color);
    }
    button {
      background: var(--primary-color);
      color: #fff;
      font-weight: bold;
      border: none;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover { background: #00bde0; }

    .terms-box {
      display: flex;
      align-items: center;
      font-size: 13px;
      margin-top: 8px;
    }
    .terms-box input { width: auto; margin-right: 6px; }
    .terms-box a {
      color: var(--accent);
      cursor: pointer;
      text-decoration: underline;
    }

    .msg {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      font-size: 14px;
      text-align: center;
    }
    .msg.error { background: #ffebee; color: #c62828; }
    .msg.success { background: #e8f5e9; color: #2e7d32; }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: var(--card-bg);
      color: var(--text-color);
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      position: relative;
    }
    .close {
      position: absolute;
      right: 15px;
      top: 10px;
      cursor: pointer;
      font-size: 20px;
      font-weight: bold;
      color: var(--accent);
    }
    .modal h3 {
      color: var(--primary-color);
      margin-top: 0;
    }
    .agree-btn {
      background: var(--accent);
      border: none;
      color: #fff;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="form-box">
    <h2>Create Account</h2>
    <form method="POST" id="registerForm">
      <input type="text" name="username" placeholder="Username" required />
      <input type="text" name="email" placeholder="Email or Mobile" required />
      <input type="password" name="password" placeholder="Password" required />
      <input type="password" name="confirm_password" placeholder="Confirm Password" required />
      <input type="text" name="referral_code" placeholder="Referral Code (optional)" />

      <div class="terms-box">
        <input type="checkbox" id="agree_terms" name="agree_terms" />
        <label for="agree_terms">
          I agree to the <a id="openTerms">Terms of Service</a> & <a id="openPrivacy">Privacy Policy</a>
        </label>
      </div>

      <button type="submit">Register</button>
    </form>

    {% if msg %}
      <div class="msg {{ msg_type }}">{{ msg }}</div>
    {% endif %}
    <p>Already have an account? <a href="/login">Login here</a></p>
  </div>

  <!-- Modal -->
  <div id="termsModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeModal">&times;</span>
      <h3>EVOSGPT Terms of Service & EVOSToken Policy</h3>

      <p><strong>1. General Usage Terms</strong><br>
      EVOSGPT is an AI-powered assistant platform. By registering, you agree to use it responsibly and avoid spam, abuse, or any illegal activity.</p>

      <p><strong>2. EVOSToken Policy</strong><br>
      EVOSToken is an internal credit system with no real-world monetary value. Tokens are earned through chat interactions and referrals. Tokens can be redeemed for in-platform upgrades or exclusive features but cannot be sold, withdrawn, or traded externally. Large redemptions may take 1–24 hours to process.</p>

      <p><strong>3. Data & Privacy</strong><br>
      User chats may be used anonymously to improve model accuracy and user experience. No personally identifiable data is ever shared publicly. All sensitive information is encrypted and protected by strict data policies.</p>

      <p><strong>4. Payments</strong><br>
      EVOSGPT paid tiers include Core ($1), Pro ($5), and King ($9). Refunds are only available if a technical issue prevents a successful tier upgrade or activation.</p>

      <p><strong>5. Referral System</strong><br>
      You may share your referral link to invite friends. Each valid referral grants bonus EVOSTokens. Fraudulent or self-referrals will result in referral suspension or account restrictions.</p>

      <p><strong>6. Privacy & Security</strong><br>
      EVOSGPT ensures your information remains secure. We never sell or share personal data with third parties. All user content and messages are transmitted securely.</p>

      <p><strong>7. Acknowledgment</strong><br>
      By clicking “I Agree,” you confirm that you have read, understood, and accepted the Terms of Service and EVOSToken Policy.</p>

      <button class="agree-btn" id="agreeClose">Agree & Close</button>
    </div>
  </div>

  <script>
    // Theme setup
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme) document.body.setAttribute("data-theme", savedTheme);
    else if (window.matchMedia("(prefers-color-scheme: dark)").matches)
      document.body.setAttribute("data-theme", "dark");

    // Modal logic
    const modal = document.getElementById("termsModal");
    const openTerms = document.getElementById("openTerms");
    const openPrivacy = document.getElementById("openPrivacy");
    const closeModal = document.getElementById("closeModal");
    const agreeClose = document.getElementById("agreeClose");

    openTerms.onclick = openPrivacy.onclick = () => modal.style.display = "flex";
    closeModal.onclick = () => modal.style.display = "none";
    agreeClose.onclick = () => {
      modal.style.display = "none";
      document.getElementById("agree_terms").checked = true;
    };
    window.onclick = (e) => { if (e.target === modal) modal.style.display = "none"; };

    // Form validation
    document.getElementById("registerForm").addEventListener("submit", (e) => {
      const checkbox = document.getElementById("agree_terms");
      if (!checkbox.checked) {
        e.preventDefault();
        alert("Please agree to the Terms & Privacy Policy before continuing.");
      }
    });
  </script>
</body>
</html>
